# PiGFX- CHANGES.MD

Versions and modifications.

## Version 2.0.0 - Enhanced Edition - 2025 August 16th

### Major Features: Two-Stage Configuration & Unified Build System

**Two-Stage Configuration System:**
* Safe boot configuration applied before "Waiting for UART.." message
* User configuration applied after UART initialization for proper timing
* Fixes font and color configuration persistence issues
* Ensures correct display settings from system startup

**Dynamic Resolution Switching:**
* Added support for dynamic switching between 640x480 and 1024x768
* Automatic framebuffer re-initialization without reboot
* Configurable via pigfx.txt and runtime commands
* Seamless resolution changes during operation

**Enhanced Configuration Documentation:**
* Complete color palette documentation (0-255 index mapping)
* Comprehensive font selection guide with all available indices
* Detailed configuration examples in pigfx.txt
* Clear explanations for all configuration parameters

**Advanced Setup Dialog:**
* Enhanced setup dialog with 6 configuration options
* Interactive font and color selection
* Resolution switching capabilities
* Improved user experience for configuration changes

**Unified Build System:**
* Single RPI variable controls entire build process (RPI=1,2,3,4)
* Automatic toolchain selection based on Pi version:
  - Pi 1-3: arm-none-eabi- toolchain
  - Pi 4: aarch64-linux-gnu- toolchain
* Intelligent uspi library management:
  - Automatic building for Pi 1-3
  - Skipped for Pi 4 (not required)
  - Auto-regeneration of Config.mk when switching Pi versions
* Simplified development workflow - no manual toolchain configuration
* Clear build information display showing Pi model, toolchain, and status

**Build System Improvements:**
* Removed multi-Pi kernel builds (kernel7, kernel8-32, recovery7)
* Unified makeall script for streamlined building
* Automatic cross-compilation setup
* Proper architecture-specific compiler flags
* Enhanced build validation and error handling

**Technical Improvements:**
* Fixed font registry error handling (proper return value checking)
* Improved configuration timing and persistence
* Enhanced framebuffer management
* Better error recovery and system stability
* Optimized configuration loading sequence

### Breaking Changes:
* Removed separate kernel builds - use RPI variable instead
* Deprecated traditional ./makeall in favor of make RPI=X
* Configuration timing changed - some settings applied later in boot sequence

### Migration Guide:
* Replace `./makeall` with `make RPI=1` (or appropriate Pi version)
* Update build scripts to use new RPI variable
* Review pigfx.txt configuration with new documentation

## Version 1.5.0 - 2020 June 9th

* PS/2 keyboard support

## Version 1.4.0 - 2020 June 3th

* Keyboard layout can now be configured in pigfx.txt
* Pressed keys repeat the key

## Version 1.3.0 - 2020 May 29th

* Read a config file (no more compiling for your needs)
* Baudrate can be set now for all Pi's before generation 4

## Version 1.2.1 - 2020 May 26th

* Always use UART0 for all models
* Bugfix with keyboard LEDs (error if no keyboard found)

## Version 1.2.0 - 2020 May 19th

* Working on all Raspberry Pi's generation 1, 2 and 3 including the PiZero and PiZero W

## Version 1.1.5 - 2020 May 9th

* Reimplemented timer functions in c

## Version 1.1.5 - 2020 May 9th

* Bugfix: Some USB keyboards not working

## Version 1.1.4 - 2020 May 5th

* Bugfix: clear line from cursor
* new commands for clear screan until cursor and clear screen from cursor

## Version 1.1.3 - 2020 May 5th

* added circle and triangle draw commands
* set baudrate from config.txt file
* pull up for RX pin
* get and display Raspberry generation
* heartbeat on ACT LED for PI B+

## Version 1.1.2 - 2019 Oct 9th

* ignore fractional part in numbers (coordinates)
* fix cursor positions (reversed parameters orders for row / col in 'H' command)

## Version 1.1.1 - 2019 Jan 21

* coordinates in the "H" escape sequence are now 1-based instead of 0-based.

## Version 1.1.0 - 2018 Dec 16th

Major features added:

+ 8x16 and 8x24 TRS-80 fonts
+ Generalized the buildfont utility to create other fonts
+ escape sequences to change font
+ escape sequence to change resolution
+ escape sequence to change tabulation width
+ escape sequence to change sprites and characters drawing mode to XOR or transparent

Tested on an RC2014 with PiZero Terminal.

## 1.0

This number concerns the initial PIGFX version by Filippo Bergamasco. Although no software version is encoded in source files, 
this version has a version constant defined in `pigfx_config.h`, which is generated by `make` using the Git deposit version number.

A 3 numbers software version has been added in `pigfx_config.h.in`, which is generated in `pigfx_config.h`and displayed at boot.

